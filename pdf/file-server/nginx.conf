server {
    listen 80;
    server_name localhost;
    charset utf-8;
    
    client_max_body_size 100M;
    
    # 根路徑 - 目錄瀏覽
    location / {
        root /usr/share/nginx/html;
        autoindex on;
        autoindex_exact_size off;
        autoindex_localtime on;
        charset utf-8;
        
        # CORS 設定
        add_header Access-Control-Allow-Origin * always;
        add_header Access-Control-Allow-Methods 'GET, OPTIONS' always;
        add_header Access-Control-Allow-Headers 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range' always;
        
        if ($request_method = 'OPTIONS') {
            return 204;
        }
    }
    
    # PDF 文件處理
    location ~ \.pdf$ {
        root /usr/share/nginx/html;
        
        # 支援範圍請求（用於 PDF 預覽）
        add_header Accept-Ranges bytes;
        add_header Access-Control-Allow-Origin * always;
        
        # 可選：強制下載
        # add_header Content-Disposition 'attachment';
    }
    
    # 健康檢查
    location /health {
        access_log off;
        return 200 "healthy\n";
        add_header Content-Type text/plain;
    }
    
    # 錯誤頁面
    error_page 404 /404.html;
    location = /404.html {
        return 404 "文件未找到\n";
    }
}
